# Expense Predictor Configuration File
# This file contains all configurable parameters for the expense prediction system.
# You can modify these values to customize the behavior of the models and data processing.

# Logging Configuration
logging:
  # Logging level for the application
  # Valid values: DEBUG, INFO, WARNING, ERROR, CRITICAL
  # Default: INFO (general informational messages)
  level: INFO

# Data Processing Configuration
data_processing:
  # Number of rows to skip when reading Excel files (bank statement specific)
  # Default: 12 (common for many bank statement formats)
  skiprows: 12

# Model Evaluation Configuration
model_evaluation:
  # Proportion of data to use for testing (0.0 to 1.0)
  # Default: 0.2 (20% of data used for testing, 80% for training)
  test_size: 0.2

  # Random seed for reproducibility
  # Default: 42
  random_state: 42

  # Minimum total samples required for training
  # Default: 30 (recommended minimum for meaningful ML predictions)
  min_total_samples: 30

  # Minimum test samples required after split
  # Default: 10 (ensures adequate test set for evaluation)
  min_test_samples: 10

# Target Transformation Configuration
target_transform:
  # Enable/disable target variable transformation
  # Default: false (no transformation applied)
  enabled: false

  # Transformation method to apply
  # Options: 'log1p' (log(1 + x), robust to zeros), 'log' (natural log, requires positive values)
  # Default: 'log1p' (recommended for expense data with zeros)
  method: log1p

# Baseline Forecast Configuration
baselines:
  # Enable/disable baseline forecasts and comparison report
  enabled: true

  # Rolling mean window sizes in months
  rolling_windows_months:
    - 3
    - 6

# Time-Series Feature Engineering Configuration
feature_engineering:
  # Enable/disable time-series feature engineering (lags, rolling stats, calendar)
  # Default: true
  enabled: true

  # Lag features: target value from N days prior
  # Captures recent spending momentum and short-term patterns
  # Default: [1, 3, 6, 12] (1-day, 3-day, 6-day, 12-day lags)
  lags:
    - 1
    - 3
    - 6
    - 12

  # Rolling window sizes in days for mean and standard deviation
  # Captures spending trends and volatility over different horizons
  # Default: [7, 14, 30] (weekly, bi-weekly, monthly)
  rolling_windows:
    - 7
    - 14
    - 30

  # Enable quarter and year calendar features
  # Month and Day of Month are always included in the base pipeline
  # Default: true
  calendar: true

# Constrained Hyperparameter Tuning Configuration
tuning:
  # Enable/disable constrained hyperparameter tuning for tree-based models
  enabled: true

  # Number of time-series splits for time-aware cross-validation
  time_series_splits: 4

  # Number of top-performing configurations to log
  top_k_log: 5

  # Reuse saved hyperparameters if available
  reuse_saved_params: true

  # Relative path (under output_dir) to persist best hyperparameters
  persist_path: reports/best_hyperparameters.json

  # Decision Tree tuning grid (constrained)
  decision_tree:
    max_depth: [3, 4, 5, 6]
    min_samples_leaf: [5, 10, 20]

  # Random Forest tuning grid (constrained)
  random_forest:
    max_depth: [4, 6, 8, 10]
    min_samples_leaf: [2, 5, 10]
    subsample: [0.6, 0.8, 1.0]

  # Gradient Boosting tuning grid (constrained)
  gradient_boosting:
    max_depth: [2, 3, 4, 5]
    min_samples_leaf: [5, 10, 20]
    subsample: [0.6, 0.8, 1.0]

# Model Hyperparameters
# These parameters control the behavior and complexity of each machine learning model

# Decision Tree Regressor Configuration
decision_tree:
  # Maximum depth of the tree (controls model complexity)
  # Lower values prevent overfitting, higher values allow more complex patterns
  max_depth: 5

  # Minimum samples required to split an internal node
  # Higher values prevent overfitting by requiring more data to make splits
  min_samples_split: 10

  # Minimum samples required at a leaf node
  # Higher values create simpler models with smoother predictions
  min_samples_leaf: 5

  # Complexity parameter for pruning (0.0 to 1.0)
  # Higher values result in more pruning and simpler trees
  ccp_alpha: 0.01

  # Random seed for reproducibility
  random_state: 42

# Random Forest Regressor Configuration
random_forest:
  # Number of trees in the forest
  # More trees generally improve performance but increase computation time
  n_estimators: 100

  # Maximum depth of each tree
  # Lower values prevent overfitting
  max_depth: 10

  # Minimum samples required to split an internal node
  min_samples_split: 10

  # Minimum samples required at a leaf node
  min_samples_leaf: 5

  # Number of features to consider when looking for the best split
  # Options: "sqrt" (square root of total features), "log2", or a number
  max_features: "sqrt"

  # Complexity parameter for pruning
  ccp_alpha: 0.01

  # Random seed for reproducibility
  random_state: 42

# Gradient Boosting Regressor Configuration
gradient_boosting:
  # Number of boosting stages (trees) to perform
  # More stages can improve performance but risk overfitting
  n_estimators: 100

  # Learning rate (step size shrinkage)
  # Lower values require more estimators but can improve generalization
  # Typical range: 0.01 to 0.3
  learning_rate: 0.1

  # Maximum depth of each tree
  # Lower values prevent overfitting
  max_depth: 5

  # Minimum samples required to split an internal node
  min_samples_split: 10

  # Minimum samples required at a leaf node
  min_samples_leaf: 5

  # Number of features to consider when looking for the best split
  max_features: "sqrt"

  # Random seed for reproducibility
  random_state: 42

# Production Model Configuration
production:
  # Default model to use for production predictions
  # Options: "Linear Regression", "Decision Tree", "Random Forest", "Gradient Boosting", "SARIMAX", "Prophet"
  # This will be automatically updated based on best performing model
  default_model: "Gradient Boosting"

# Dedicated Time-Series Models
time_series_models:
  # Enable/disable dedicated forecasting models (SARIMAX + Prophet)
  enabled: false

  # Persist fitted model artifacts to output_dir/artifacts/
  save_artifacts: true

  sarimax:
    enabled: true
    # SARIMAX (p,d,q)
    order: [1, 1, 1]
    # Seasonal SARIMAX (P,D,Q,s), default weekly seasonality for daily data
    seasonal_order: [1, 1, 1, 7]
    # Trend component: n (none), c (constant), t (linear), ct (constant+linear)
    trend: c
    # Include engineered features as exogenous regressors
    use_exogenous: true

  prophet:
    enabled: true
    yearly_seasonality: true
    weekly_seasonality: true
    daily_seasonality: false
    seasonality_mode: additive
    changepoint_prior_scale: 0.05
    # Include engineered features as additional regressors
    use_exogenous: true
